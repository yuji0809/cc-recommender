---
name: pre-commit-check
description: "コミット前の包括的なコードチェック（アーキテクチャ、セキュリティ、TypeScript）"
---

# コミット前チェック

このコマンドは、コミット前に以下の4つのチェックを**並列**で実行します：

## チェック内容

1. **アーキテクチャチェック** - 設計思想とディレクトリ構造の確認
2. **セキュリティチェック** - セキュリティベストプラクティスの確認
3. **TypeScriptチェック** - 型安全性とベストプラクティスの確認
4. **ドキュメントチェック** - MDファイルの最新性とコードとの整合性の確認

## 実行方法

4つのエージェントを**並列で同時に**呼び出して、最近の変更をチェックしてください。

### 並列実行

以下の4つのエージェントを同時に起動します：

**Architecture Agent:**
```
最近変更されたファイルをチェックして、アーキテクチャガイドラインに沿っているか確認してください。特に以下を確認：
- ファイルの配置は適切か
- ファイル命名規則に従っているか
- 直接インポートを使用しているか
- レイヤー間の依存方向は正しいか
- 循環依存はないか
```

**Security Agent:**
```
最近変更されたファイルをチェックして、セキュリティベストプラクティスに従っているか確認してください。特に以下を確認：
- 機密情報が含まれていないか
- 入力バリデーションは適切か
- コマンドインジェクションの脆弱性はないか
- ファイル操作は安全か
- エラーハンドリングは適切か
```

**TypeScript Agent:**
```
最近変更されたファイルをチェックして、TypeScriptのベストプラクティスに従っているか確認してください。特に以下を確認：
- any を使用していないか
- 型推論を適切に活用しているか
- interface ではなく type を使用しているか
- 関数の型定義は適切か
- エラーハンドリングは型安全か
```

**Documentation Agent:**
```
最近変更されたファイルに関連するドキュメントをチェックして、最新の状態になっているか確認してください。特に以下を確認：
- 新機能が追加された場合、README.md に記載されているか
- 新しいファイル・ディレクトリが追加された場合、CLAUDE.md に記載されているか
- アーキテクチャ変更がある場合、docs/ARCHITECTURE.md に反映されているか
- README.md と README.ja.md が同期されているか
- CHANGELOG.md に今回の変更が記録されているか
- コードサンプルが最新の実装と一致しているか
```

> **💡 並列実行のメリット:** 4つのチェックが同時に実行されるため、順次実行よりも大幅に高速です。

## チェック完了後

すべてのチェックが完了したら、以下を確認してください：

- [ ] アーキテクチャチェックで問題が指摘されていないか
- [ ] セキュリティチェックで問題が指摘されていないか
- [ ] TypeScriptチェックで問題が指摘されていないか
- [ ] ドキュメントチェックで問題が指摘されていないか
- [ ] 指摘された問題をすべて修正したか
- [ ] ドキュメントが最新の状態に更新されているか

すべてクリアした場合のみコミットを実行してください。

## 自動チェックコマンド

手動チェックの前に、以下の自動チェックも実行することを推奨します：

```bash
# 型チェック
pnpm run typecheck

# Lint
pnpm run lint

# セキュリティ監査
pnpm run audit

# ライセンスチェック
pnpm run license:check

# 全チェック
pnpm run check
```

## 注意事項

- このコマンドは **コミット前** に実行してください
- 問題が見つかった場合は、必ず修正してからコミットしてください
- CI/CDでも同様のチェックが実行されるため、ローカルで事前に確認することで時間を節約できます
