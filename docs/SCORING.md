# スコアリングシステム

cc-recommenderは、プロジェクト情報に基づいて各推薦アイテムのマッチスコアを計算します。

## スコアの計算方法

### 基本スコア

各マッチタイプに応じてポイントが加算されます：

| マッチタイプ | ポイント | 説明 |
|------------|---------|------|
| **言語マッチ** | +5 / 1件 | プロジェクトで使用されている言語に対応 |
| **フレームワークマッチ** | +4 / 1件 | プロジェクトで使用されているフレームワークに対応 |
| **依存関係マッチ** | +3 / 1件 | プロジェクトの依存関係（package.json等）に直接含まれている |
| **ファイルパターンマッチ** | +2 / 1件 | 特定のファイルパターンが存在する |
| **キーワードマッチ** | +1 / 1件 | 検索キーワード、タグ、名前が一致 |

### スコア倍率

品質指標によって最終スコアが調整されます：

| 倍率 | 条件 | 説明 |
|-----|------|------|
| **×1.3** | 公式アイテム | 公式プラグイン・MCPサーバーには信頼性ボーナス |
| **×1.1** | 高セキュリティ | セキュリティスコア > 80 の安全なアイテム |
| **×0.7** | 低セキュリティ | セキュリティスコア < 50 の要注意アイテム |

### 最終スコア

生スコアは1-100点の範囲に正規化されます：

```
生スコア = (基本スコアの合計) × (品質倍率)
最終スコア = min(100, max(1, (生スコア / 50) × 100))
```

## スコアの意味

| スコア範囲 | 表示 | 意味 |
|-----------|------|------|
| **80-100点** | ✅ 高適合 | プロジェクトに強く推薦します |
| **50-79点** | 👍 適合 | プロジェクトに適合します |
| **20-49点** | 📝 参考 | 参考として有用な場合があります |
| **1-19点** | (非表示) | 関連性が低いため表示されません |

## 計算例

### 例1: TypeScript + React + Supabase プロジェクト

公式のSupabase MCPサーバーを推薦する場合：

```
言語マッチ (TypeScript):    +5
フレームワークマッチ (React): +4
依存関係マッチ (Supabase):   +3
---
基本スコア合計:              12
公式倍率:                    ×1.3
---
生スコア:                    15.6
正規化:                      (15.6 / 50) × 100 = 31点
最終スコア:                  31点 📝 参考

※ さらに多くのマッチがある場合:
生スコア:                    40.0
正規化:                      (40.0 / 50) × 100 = 80点
最終スコア:                  80点 ✅ 高適合
```

### 例2: Python プロジェクト

Python向けのツールを推薦する場合：

```
言語マッチ (Python):         +5
---
基本スコア合計:              5
倍率なし:                    ×1.0
---
生スコア:                    5.0
正規化:                      (5.0 / 50) × 100 = 10点
最終スコア:                  10点 (表示されない)
```

### 例3: 検索キーワード "database"

データベース関連のMCPサーバーを検索する場合：

```
キーワードマッチ (database): +1
キーワードマッチ (tags):     +1
---
基本スコア合計:              2
倍率なし:                    ×1.0
---
生スコア:                    2.0
正規化:                      (2.0 / 50) × 100 = 4点
最終スコア:                  4点 (表示されない)
```

## スコアの活用方法

### 推薦結果の解釈

- **✅ 高適合 (80-100点)**: このアイテムはプロジェクトに非常に適しています。優先的にインストールを検討してください。

- **👍 適合 (50-79点)**: このアイテムはプロジェクトに適しています。必要に応じてインストールを検討してください。

- **📝 参考 (20-49点)**: このアイテムは特定の状況で役立つ可能性があります。詳細を確認してから判断してください。

### マッチ内容の確認

推薦結果には「マッチ内容」が表示されます。これにより、なぜそのアイテムが推薦されたのかを理解できます：

```
├─ マッチ内容: 言語: typescript, フレームワーク: react, 依存関係: supabase
```

この情報を見れば、推薦の根拠が明確になります。

## 設定のカスタマイズ

現在、スコアリングの重みや倍率は固定されていますが、将来のバージョンでカスタマイズ可能になる予定です。

詳細は [`src/config/scoring-config.ts`](../src/config/scoring-config.ts) を参照してください。
